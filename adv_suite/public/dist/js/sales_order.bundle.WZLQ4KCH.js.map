{
  "version": 3,
  "sources": ["../../../../../apps/adv_suite/adv_suite/public/js/sales_order/sales_order_custom.js"],
  "sourcesContent": ["// Extender la clase SalesOrderController\nclass CustomSalesOrderController extends erpnext.selling.SalesOrderController {\n    make_work_order() {\n        var me = this;\n        me.frm.call({\n            method: \"erpnext.selling.doctype.sales_order.sales_order.get_work_order_items\",\n            args: {\n                sales_order: this.frm.docname,\n            },\n            freeze: true,\n            callback: function(r) {\n                if (!r.message) {\n                    frappe.msgprint({\n                        title: __(\"Work Order not created\"),\n                        message: __(\"No Items with Bill of Materials to Manufacture\"),\n                        indicator: \"orange\",\n                    });\n                    return;\n                } else {\n                    const fields = [\n                        {\n                            label: \"Items\",\n                            fieldtype: \"Table\",\n                            fieldname: \"items\",\n                            description: __(\"Select BOM and Qty for Production\"),\n                            fields: [\n                                {\n                                    fieldtype: \"Read Only\",\n                                    fieldname: \"item_code\",\n                                    label: __(\"Item Code\"),\n                                    in_list_view: 1,\n                                },\n                                {\n                                    fieldtype: \"Link\",\n                                    fieldname: \"bom\",\n                                    options: \"BOM\",\n                                    reqd: 1,\n                                    read_only: 1, // Hacer el campo bom de solo lectura\n                                    label: __(\"Select BOM\"),\n                                    in_list_view: 1,\n                                    get_query: function(doc) {\n                                        return { filters: { item: doc.item_code } };\n                                    },\n                                },\n                                {\n                                    fieldtype: \"Float\",\n                                    fieldname: \"pending_qty\",\n                                    reqd: 1,\n                                    label: __(\"Qty\"),\n                                    in_list_view: 1,\n                                },\n                                {\n                                    fieldtype: \"Data\",\n                                    fieldname: \"sales_order_item\",\n                                    reqd: 1,\n                                    label: __(\"Sales Order Item\"),\n                                    hidden: 1,\n                                },\n                            ],\n                            data: r.message,\n                            get_data: () => {\n                                return r.message;\n                            },\n                        },\n                    ];\n                    var d = new frappe.ui.Dialog({\n                        title: __(\"Select Items to Manufacture\"),\n                        fields: fields,\n                        primary_action: function() {\n                            var data = { items: d.fields_dict.items.grid.get_selected_children() };\n                            if (!data) {\n                                frappe.throw(__(\"Please select items\"));\n                            }\n                            me.frm.call({\n                                method: \"make_work_orders\",\n                                args: {\n                                    items: data,\n                                    company: me.frm.doc.company,\n                                    sales_order: me.frm.docname,\n                                    project: me.frm.project,\n                                },\n                                freeze: true,\n                                callback: function(r) {\n                                    if (r.message) {\n                                        frappe.msgprint({\n                                            message: __(\"Work Orders Created: {0}\", [\n                                                r.message\n                                                    .map(function(d) {\n                                                        return repl(\n                                                            '<a href=\"/app/work-order/%(name)s\">%(name)s</a>',\n                                                            { name: d }\n                                                        );\n                                                    })\n                                                    .join(\", \"),\n                                            ]),\n                                            indicator: \"green\",\n                                        });\n                                    }\n                                    d.hide();\n                                },\n                            });\n                        },\n                        primary_action_label: __(\"Create\"),\n                    });\n\n                    d.show();\n                }\n            },\n        });\n    }\n};\n\n\n// Asignar la nueva clase a erpnext.selling.SalesOrderController\nerpnext.selling.SalesOrderController = CustomSalesOrderController;\n\n// Aplicar la nueva clase al formulario actual\nextend_cscript(cur_frm.cscript, new erpnext.selling.SalesOrderController({ frm: cur_frm }));\n\n\n\nfrappe.ui.form.on('Sales Order', {\n    onload: function(frm) {\n        $(frm.fields_dict.custom_notes.wrapper).find('textarea').css('height', '75px');\n    },\n    onload_post_render: function(frm) {        \n        // Ajustar la altura del campo custom_notes\n        $(frm.fields_dict.custom_notes.wrapper).find('textarea').css('height', '75px');\n\n    },\n    refresh: function(frm) {\n        $(frm.fields_dict.custom_notes.wrapper).find('textarea').css('height', '75px');\n    }\n});"],
  "mappings": "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",
  "names": ["r", "d"]
}
