{
  "version": 3,
  "sources": ["../../../../../apps/adv_suite/adv_suite/public/js/bom/bom_custom.js"],
  "sourcesContent": ["frappe.ui.form.on('BOM', {\n    onload: function(frm) {\n        calculate_margin_values(frm);\n    },\n    onload_post_render: function(frm) {\n        // Aplicar personalizaciones basadas en roles\n        if (frappe.user.has_role('AUXILIAR ALMACEN') && !frappe.user.has_role(\"Administrator\")) {\n            console.log('Aplicando personalizaciones basadas en roles para el formulario BOM');\n            // Ocultar la l\u00EDnea de tiempo de los comentarios\n            if (frm.timeline.wrapper) {\n                frm.timeline.wrapper.hide();\n            }\n            apply_role_based_customizations(frm, \"items\");\n        }\n        // Recuperar los valores de los separadores desde Advertech Settings y guardarlos en el formulario\n        frappe.call({\n            method: 'frappe.client.get_value',\n            args: {\n                doctype: 'Advertech Settings',\n                fieldname: ['bom_items_separator']\n            },\n            callback: function(r) {\n                if (r.message) {\n                    frm.bom_items_separator = r.message.bom_items_separator || '|';\n                }\n            }\n        });\n        add_copy_icon_to_table(frm);\n        \n        // Ajustar la altura del campo custom_bom_description\n        $(frm.fields_dict.custom_bom_description.wrapper).find('textarea').css('height', '75px');\n\n    },\n    custom_margin_type: function(frm) {\n        reset_margin_fields(frm);\n        toggle_margin_fields(frm);\n        calculate_margin_values(frm);    \n    },\n    custom_margin_rate_or_amount: function(frm) {\n        // Recalcular los valores cuando custom_margin_rate_or_amount cambie\n        calculate_margin_values(frm);\n    },\n    custom_margin_amount: function(frm) {\n        // Recalcular los valores cuando custom_margin_amount cambie\n        calculate_margin_values(frm);\n    },\n    total_cost: function(frm) {\n        // Recalcular los valores cuando total_cost cambie\n        calculate_margin_values(frm);\n    },\n    custom_total_to_quote: function(frm) {\n        // Recalcular los valores cuando custom_total_to_quote cambie\n        calculate_margin_values(frm);\n    },\n    items_on_form_rendered(doc, doctype,docname) {\n        // se ejecuta cuando se renderiza el formulario modal\n\t},\n    before_submit: function(frm) {\n        if (!frm.doc.custom_warehouse_verified_materials) {\n            frappe.msgprint(__('Es requerido confirmar que se ha realizado la verificaci\u00F3n por Almac\u00E9n de la disponibilidad de materiales.'));\n            frappe.validated = false;\n        }\n    },\n\n});\n\n// function calculate_margin_values(frm) {\n//     let margin_type = frm.doc.custom_margin_type || 'Percentage'; // Valor predeterminado 'Percentage'\n//     let margin_rate_or_amount = frm.doc.custom_margin_rate_or_amount || 0; // Valor predeterminado 0\n\n//     let effective_item_rate = frm.doc.total_cost || 0;\n\n\n//     if (margin_type== \"Percentage\") {\n//         let margin_rate_or_amount = frm.doc.custom_margin_rate_or_amount || 0;\n//         let margin_amount = flt(effective_item_rate) * (flt(margin_rate_or_amount) / 100);\n//         frm.set_value('custom_margin_amount', margin_amount);\n//         frm.set_value('custom_rate_with_margin', flt(effective_item_rate) + margin_amount);\n//     } else if (margin_type== \"Amount\"){\n//         let margin_amount = frm.doc.custom_margin_amount || 0;\n//         // Calcular el porcentaje de margen basado en el costo efectivo del \u00EDtem\n//         effective_item_rate = flt(effective_item_rate);\n//         margin_amount = flt(margin_amount);\n//         let margin_rate_or_amount = 0;\n//         if (effective_item_rate > 0) {\n//             margin_rate_or_amount = (margin_amount / effective_item_rate) * 100;\n//         }\n//         frm.set_value('custom_margin_rate_or_amount', margin_rate_or_amount);\n//         frm.set_value('custom_rate_with_margin', flt(effective_item_rate) + flt(margin_amount));\n//     }else{\n//         console.log('No se ha seleccionado un tipo de margen');\n//         frm.set_value('custom_rate_with_margin', effective_item_rate);\n//     }\n\n//     if (!margin_type) {\n//         toggle_margin_fields(frm);\n//     } else {\n//         if (margin_type== \"Percentage\") {\n//             frm.toggle_display('custom_margin_rate_or_amount', true);\n//             if (frm.doc.custom_margin_rate_or_amount == 0) {\n//                 frm.toggle_display('custom_margin_amount', false);\n//             }else{\n//                 frm.toggle_display('custom_margin_amount', true);\n//                 frm.set_df_property('custom_margin_amount', 'read_only', 1);\n//             }        \n//         } else if (margin_type== \"Amount\"){\n//             frm.toggle_display('custom_margin_amount', true);\n\n//             if (frm.doc.custom_margin_amount == 0) {\n//                 frm.toggle_display('custom_margin_rate_or_amount', false);\n//             }else{\n//                 frm.toggle_display('custom_margin_rate_or_amount', true);\n//                 frm.set_df_property('custom_margin_rate_or_amount', 'read_only', 1);\n//             }\n    \n//         }\n//     }\n// }\n\n// function reset_margin_fields(frm) {\n//     frm.set_value('custom_margin_rate_or_amount', 0);\n//     frm.set_value('custom_margin_amount', 0);\n//     frm.set_df_property('custom_margin_rate_or_amount', 'read_only', 0);\n//     frm.set_df_property('custom_margin_amount', 'read_only', 0);\n// }\n\n// function toggle_margin_fields(frm) {\n//     frm.toggle_display('custom_margin_rate_or_amount', false);\n//     frm.toggle_display('custom_margin_amount', false);\n// }\n\n\nfunction calculate_margin_values(frm) {\n    let margin_type = frm.doc.custom_margin_type || 'Percentage'; // Valor predeterminado 'Percentage'\n    frm.set_value('custom_margin_type', margin_type);\n    let margin_rate_or_amount = frm.doc.custom_margin_rate_or_amount || 0; // Valor predeterminado 0\n\n    let effective_item_rate = frm.doc.total_cost || 0;\n\n    if (margin_type == \"Percentage\") {\n        let margin_rate_or_amount = frm.doc.custom_margin_rate_or_amount || 0;\n        let margin_amount = flt(effective_item_rate) * (flt(margin_rate_or_amount) / 100);\n        frm.set_value('custom_margin_amount', margin_amount);\n        frm.set_value('custom_rate_with_margin', flt(effective_item_rate) + margin_amount);\n    } else if (margin_type == \"Amount\") {\n        let margin_amount = frm.doc.custom_margin_amount || 0;\n        // Calcular el porcentaje de margen basado en el costo efectivo del \u00EDtem\n        effective_item_rate = flt(effective_item_rate);\n        margin_amount = flt(margin_amount);\n        let margin_rate_or_amount = 0;\n        if (effective_item_rate > 0) {\n            margin_rate_or_amount = (margin_amount / effective_item_rate) * 100;\n        }\n        frm.set_value('custom_margin_rate_or_amount', margin_rate_or_amount);\n        frm.set_value('custom_rate_with_margin', flt(effective_item_rate) + flt(margin_amount));\n    } else if (margin_type == \"Total to Quote\") {\n        let custom_total_to_quote = frm.doc.custom_total_to_quote || effective_item_rate;\n\n        let margin_amount = custom_total_to_quote - effective_item_rate;\n        let margin_rate_or_amount = 0;\n        if (effective_item_rate > 0) {\n            margin_rate_or_amount = (margin_amount / effective_item_rate) * 100;\n        }\n        frm.set_value('custom_margin_rate_or_amount', margin_rate_or_amount);\n        frm.set_value('custom_margin_amount', margin_amount);\n        frm.set_value('custom_rate_with_margin', custom_total_to_quote);\n    } else {\n        console.log('No se ha seleccionado un tipo de margen');\n        frm.set_value('custom_rate_with_margin', effective_item_rate);\n    }\n\n    if (!margin_type) {\n        toggle_margin_fields(frm);\n    } else {\n        if (margin_type == \"Percentage\") {\n            frm.toggle_display('custom_margin_rate_or_amount', true);\n            frm.toggle_display('custom_total_to_quote', false);\n            \n            if (frm.doc.custom_margin_rate_or_amount == 0) {\n                frm.toggle_display('custom_margin_amount', false);\n            } else {\n                frm.toggle_display('custom_margin_amount', true);\n                frm.set_df_property('custom_margin_amount', 'read_only', 1);\n            }\n            frm.toggle_display('custom_rate_with_margin', true);\n        } else if (margin_type == \"Amount\") {\n            frm.toggle_display('custom_margin_amount', true);\n            frm.toggle_display('custom_total_to_quote', false);\n            if (frm.doc.custom_margin_amount == 0) {\n                frm.toggle_display('custom_margin_rate_or_amount', false);\n            } else {\n                frm.toggle_display('custom_margin_rate_or_amount', true);\n                frm.set_df_property('custom_margin_rate_or_amount', 'read_only', 1);\n            }\n            frm.toggle_display('custom_rate_with_margin', true); \n        } else if (margin_type == \"Total to Quote\") {\n            frm.toggle_display('custom_total_to_quote', true);\n            frm.toggle_display('custom_margin_rate_or_amount', false);\n            frm.toggle_display('custom_margin_amount', false);\n            frm.toggle_display('custom_rate_with_margin', false);\n            if (frm.doc.custom_margin_amount == 0) {\n                frm.toggle_display('custom_margin_rate_or_amount', false);\n            } else {\n                frm.toggle_display('custom_margin_rate_or_amount', true);\n                frm.set_df_property('custom_margin_rate_or_amount', 'read_only', 1);\n            }\n            if (frm.doc.custom_margin_rate_or_amount == 0) {\n                frm.toggle_display('custom_margin_amount', false);\n            } else {\n                frm.toggle_display('custom_margin_amount', true);\n                frm.set_df_property('custom_margin_amount', 'read_only', 1);\n            }\n        }\n    }\n}\n\nfunction reset_margin_fields(frm) {\n    frm.set_value('custom_margin_rate_or_amount', 0);\n    frm.set_value('custom_margin_amount', 0);\n    frm.set_value('custom_total_to_quote', 0);\n    frm.set_df_property('custom_margin_rate_or_amount', 'read_only', 0);\n    frm.set_df_property('custom_margin_amount', 'read_only', 0);\n}\n\nfunction toggle_margin_fields(frm) {\n    frm.toggle_display('custom_margin_rate_or_amount', false);\n    frm.toggle_display('custom_margin_amount', false);\n    frm.toggle_display('custom_total_to_quote', false);\n}\n\n\nfrappe.ui.form.on('BOM Item', {\n    form_render: function(frm, cdt, cdn) {\n        if (frappe.user.has_role('AUXILIAR ALMACEN') && !frappe.user.has_role(\"Administrator\")) {\n\n            let item = locals[cdt][cdn];\n\n            // Lista de columnas a ocultar en el formulario modal\n            let columns_to_hide = ['rate', 'amount', 'base_rate', 'base_amount'];\n\n            // Iterar sobre la lista y ocultar cada columna\n            columns_to_hide.forEach(column => {\n                frm.fields_dict['items'].grid.toggle_display(column, false, item.name);\n            });\n\n                    // Obtener la fila del grid\n        let grid_row = frm.fields_dict['items'].grid.grid_rows_by_docname[cdn];\n\n        // Obtener el elemento del DOM que representa la fila\n        let row_element = grid_row.wrapper[0];\n\n        // Crear un MutationObserver para observar los cambios en las clases del elemento\n        let observer = new MutationObserver(function(mutations) {\n            mutations.forEach(function(mutation) {\n                if (mutation.attributeName === 'class') {\n                    if (!row_element.classList.contains('grid-row-open')) {\n                        apply_role_based_customizations(frm, \"items\");\n                        // console.log('Formulario cerrado para el item:', cdn);\n                    }\n                }\n            });\n        });\n\n        // Configurar el MutationObserver para observar los cambios en los atributos del elemento\n        observer.observe(row_element, { attributes: true });\n\n        }\n    }\n});\n\n\nfunction hide_columns(frm, fields, table) {\n    let grid = frm.get_field(table).grid;\n    \n    for (let field of fields) {\n        grid.fields_map[field].hidden = 1;\n    }\n    \n    grid.visible_columns = undefined;\n    grid.setup_visible_columns();\n    \n    grid.header_row.wrapper.remove();\n    delete grid.header_row;\n    grid.make_head();\n    \n    for (let row of grid.grid_rows) {\n        if (row.open_form_button) {\n            row.open_form_button.parent().remove();\n            delete row.open_form_button;\n        }\n        \n        for (let field in row.columns) {\n            if (row.columns[field] !== undefined) {\n                row.columns[field].remove();\n            }\n        }\n        delete row.columns;\n        row.columns = [];\n        row.render_row();\n    }\n}\n\nfunction hide_tabs(frm, fields, dn) {\n    prefix = dn.toLowerCase().replace(/ /g, '_');\n    fields.forEach(fieldname => {\n        let tab_id = `#${prefix}-${fieldname}`;\n        let tab_link_id = `#${prefix}-${fieldname}-tab`;\n\n        let tab = document.querySelector(tab_id);\n        let tab_link = document.querySelector(tab_link_id);\n\n        if (tab) {\n            tab.remove();\n        }\n        if (tab_link) {\n            tab_link.remove();\n        }\n    });\n}\n\nfunction hide_row_check(frm, table) {\n    \n    setTimeout(function () {\n        let grid = frm.get_field(table).grid;\n\n        grid.grid_rows.forEach(row => {\n            row.row_check[0].hidden=1;\n        });\n    \n        grid.header_row.row_check[0].hidden=1;\n\n    }, 50);\n}\n\nfunction hide_row_index(frm, table) {\n    \n    setTimeout(function () {\n        let grid = frm.get_field(table).grid;\n\n        grid.grid_rows.forEach(row => {\n            row.row_index[0].hidden=1;\n        });\n    \n        grid.header_row.row_index[0].hidden=1;\n    }, 50);\n\n}\n\nfunction hide_last_column(frm, table) {\n\n    setTimeout(function () {\n        let grid = frm.get_field(table).grid;\n\n        grid.grid_rows.forEach(row => {\n            row.open_form_button[0].parentElement.remove();\n        });\n    \n        // grid.header_row.configure_columns_button[0].parentElement.remove();\n        let header_columns = grid.wrapper[0].querySelectorAll('.grid-static-col.d-flex.justify-content-center');\n        if (header_columns.length > 0) {\n            header_columns[header_columns.length - 1].remove();\n        }\n    }, 50);\n\n}\n\nfunction apply_role_based_customizations(frm, table) {\n\n    apply_tabs_role_based_customizations(frm, table);\n\n    apply_table_role_based_customizations(frm, table);\n}\n\nfunction apply_tabs_role_based_customizations(frm, table) {\n    // Ocultar tabs\n    tabs_links = ['section_break_21', 'scrap_section', 'costing', 'more_info_tab'];\n    hide_tabs(frm, tabs_links, frm.doctype);\n}\nfunction apply_table_role_based_customizations(frm, table) {\n    // Ocultar columnas del grid\n    fields = ['rate', 'amount', 'base_rate', 'base_amount'];\n    hide_columns(frm, fields, table)\n\n    // Ocultar la primera columna del grid\n    hide_row_check(frm, table);\n\n    // Ocultar la columna de \u00EDndice del grid (ok)\n    // hide_row_index(frm, table);\n    \n    // Ocultar la \u00FAltima columna del grid\n    hide_last_column(frm, table);\n    \n    // Ocultar fotter del grid\n    // frm.fields_dict['items'].grid.wrapper.find('.grid-footer').hide();\n}\n\n// Funci\u00F3n para agregar el \u00EDcono de copiar a la tabla custom_project_materials\nfunction add_copy_icon_to_table(frm) {\n    let table_field = frm.fields_dict['items'];\n    if (!table_field) {\n        console.error('No se encontr\u00F3 el campo custom_project_materials');\n        return;\n    }\n\n    // Buscar el contenedor .form-column del campo\n    let form_column = table_field.$wrapper.closest('.form-column');\n\n    // Si no encontramos el .form-column, detener\n    if (!form_column.length) {\n        console.error('No se encontr\u00F3 el contenedor .form-column');\n        return;\n    }\n\n    // Buscar el label dentro del contenedor\n    let label_container = table_field.$wrapper.find('.control-label');\n    if (!label_container.length) {\n        console.error('No se encontr\u00F3 el contenedor del label (.control-label)');\n        return;\n    }\n\n    // Verificar si el \u00EDcono ya fue agregado\n    if (label_container.find('.copy-content-icon').length) {\n        return; // Evitar duplicados\n    }\n\n    // // Insertar el \u00EDcono despu\u00E9s del label\n    // label_container.addClass('like-disabled-input');\n    // label_container.css('position', 'relative');\n    // label_container.css('width', '100%');\n    // label_container.append(`\n    //     <button class=\"btn icon-btn copy-content-icon\" style=\"position: absolute; top: 0px; right: 1%;\" onmouseover=\"this.classList.add('btn-default')\" onmouseout=\"this.classList.remove('btn-default')\" title=\"${__('Copy')}\">\n    //         <svg class=\"es-icon es-line  icon-sm\" style=\"\" aria-hidden=\"true\">\n    //             <use class=\"\" href=\"#es-line-copy-light\"></use>\n    //         </svg>\n    //     </button>\n    // `);\n\n    label_container.addClass('like-disabled-input');\n    label_container.css('position', 'relative');\n    label_container.css('width', '100%');\n\n    // Insertar el \u00EDcono fuera del label pero dentro del form-column\n    form_column.css('position', 'relative');\n    form_column.append(`\n        <button class=\"btn icon-btn copy-content-icon\" style=\"position: absolute; top: 14px; right: 25px; transform: translateY(-50%);\" onmouseover=\"this.classList.add('btn-default')\" onmouseout=\"this.classList.remove('btn-default')\"  title=\"${__('Set time')}\">\n            <svg class=\"es-icon es-line icon-sm\" style=\"filter: opacity(0.55); stroke:none;\" aria-hidden=\"true\">\n                 <use class=\"\" href=\"#es-line-copy-light\"></use>\n            </svg>\n        </button>\n    `);\n\n\n    // Manejar el clic en el \u00EDcono\n    form_column.find('.copy-content-icon').on('click', function () {\n        // Obtener los valores del campo item_name de cada rengl\u00F3n de la tabla\n        let selected_items = frm.doc.items || [];\n\n        // Usar el separador guardado en el formulario\n        let separator = frm.bom_items_separator || '|';\n        separator = separator.replace(/\\\\n/g, '\\n'); // Convertir \"\\n\" a salto de l\u00EDnea\n\n        let concatenated_values = selected_items\n            .map(item => item.item_name)\n            .join(separator);\n\n        // Copiar al portapapeles\n        copy_to_clipboard(concatenated_values);\n\n        // Mostrar una notificaci\u00F3n tipo alert\n        frappe.show_alert({\n            message: __('Copied to clipboard'),\n            indicator: 'green'\n        });\n    });\n}\n\n// Funci\u00F3n para copiar texto al portapapeles\nfunction copy_to_clipboard(text) {\n    const textArea = document.createElement('textarea');\n    textArea.value = text;\n    document.body.appendChild(textArea);\n    textArea.select();\n    document.execCommand('copy');\n    document.body.removeChild(textArea);\n}"],
  "mappings": "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",
  "names": ["margin_rate_or_amount", "fields"]
}
